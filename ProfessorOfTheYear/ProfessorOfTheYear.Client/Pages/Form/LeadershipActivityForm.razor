@page "/form/leadership-activity"

@inject NavigationManager NavigationManager

@rendermode InteractiveAuto

@attribute [Authorize]

<PageTitle>Форма заполнения заявки</PageTitle>

<div class="block-group">
    <div class="block">
        <div class="block-title">
            <div class="block-title-text">
                Заполните заявку
            </div>
        </div>

        <EditForm EditContext="@editContext" OnValidSubmit="HandleOnValidSubmit" class="w-100">
            <DataAnnotationsValidator />

            <div class="block-content block-content-border">
                <div class="block-subtitle-text">
                    Руководство дипломными проектами за предыдущий учебный год
                </div>

                <div class="block-content-text">Защитившиеся бакалавры</div>
                <div class="form-input w-100 mb-3">
                    <ValidationMessage For="@(() => invoice.BachelorscCount)" />
                    <InputNumber EnableMinMax="true" Min="0" class="form-control" @bind-Value="invoice.BachelorscCount" Placeholder="Введите количество" />
                </div>

                <div class="block-content-text">Защитившиеся специалисты</div>
                <div class="form-input w-100 mb-3">
                    <ValidationMessage For="@(() => invoice.SpecialistsCount)" />
                    <InputNumber EnableMinMax="true" Min="0" class="form-control" @bind-Value="invoice.SpecialistsCount" Placeholder="Введите количество" />
                </div>

                <div class="block-content-text">Защитившиеся магистры</div>
                <div class="form-input w-100 mb-3">
                    <ValidationMessage For="@(() => invoice.MastersCount)" />
                    <InputNumber EnableMinMax="true" Min="0" class="form-control" @bind-Value="invoice.MastersCount" Placeholder="Введите количество" />
                </div>

                <Studyload />
            </div>

            <div class="block-content block-content-border">
                <div class="block-subtitle-text">
                    Список подготовленных под руководством участника конкурса аспирантов (докторантов) за последние пять лет научно-педагогической деятельности
                </div>

                <div class="block-content-text">Количество защитившихся кандидатов наук</div>
                <div class="form-input w-100 mb-3">
                    <ValidationMessage For="@(() => invoice.CandidatesOfSciencesCount)" />
                    <InputNumber EnableMinMax="true" Min="0" class="form-control" @bind-Value="invoice.CandidatesOfSciencesCount" Placeholder="Введите количество" />
                </div>

                <div class="block-content-text">Количество защитившихся докторов наук</div>
                <div class="form-input w-100 mb-3">
                    <ValidationMessage For="@(() => invoice.DoctorsOfSciencesCount)" />
                    <InputNumber EnableMinMax="true" Min="0" class="form-control" @bind-Value="invoice.DoctorsOfSciencesCount" Placeholder="Введите количество" />
                </div>

                <Studentlist />
            </div>

            <div class="d-flex flex-row gap-2 mt-2 mb-2 justify-content-center">
                <Button 
                    @onclick="Comeback"
                    Color="ButtonColor.Secondary">
                        Вернуться назад
                </Button>
                <Button 
                    Type="ButtonType.Submit"
                    Color="ButtonColor.Primary">
                        Продолжить
                </Button>
            </div>
        </EditForm>
    </div>
</div>

@code {
    private DataTeachingDTO.LeadershipActivity invoice = new();
    private EditContext? editContext;

    protected override void OnInitialized()
    {
        editContext = new EditContext(invoice);
        base.OnInitialized();
    }

    public void HandleOnValidSubmit()
    {
        NavigationManager.NavigateTo("/form/scientific-works");
    }

    public void Comeback()
    {
        NavigationManager.NavigateTo("/form/scientific-exp");
    }
}
