@page "/form/leadership-work"

@using ProfessorOfTheYear.Client.Model
@using System.ComponentModel.DataAnnotations

@inject NavigationManager NavigationManager
@rendermode RenderMode.InteractiveAuto

<PageTitle>Форма заполнения заявки</PageTitle>

<div class="block-group">
    <div class="block">
        <div class="block-title">
            <div class="block-title-text">
                Заполните заявку
            </div>
        </div>

        <EditForm EditContext="@editContext" OnValidSubmit="HandleOnValidSubmit" class="w-100">
            <DataAnnotationsValidator />

            <div class="block-content block-content-border">
                <div class="block-subtitle-text">
                    Руководство дипломными проектами за предыдущий учебный год
                </div>

                <div class="block-content-text">Защитившиеся бакалавры:</div>
                <div class="input-group mb-3">
                    <ValidationMessage For="@(() => invoice.bachelorscCount)" />
                    <InputNumber class="form-control" @bind-Value="invoice.bachelorscCount" Placeholder="Введите количество" />
                </div>

                <div class="block-content-text">Защитившиеся специалисты:</div>
                <div class="input-group mb-3">
                    <ValidationMessage For="@(() => invoice.specialistsCount)" />
                    <InputNumber class="form-control" @bind-Value="invoice.specialistsCount" Placeholder="Введите количество" />
                </div>

                <div class="block-content-text">Защитившиеся магистры:</div>
                <div class="input-group mb-3">
                    <ValidationMessage For="@(() => invoice.mastersCount)" />
                    <InputNumber class="form-control" @bind-Value="invoice.mastersCount" Placeholder="Введите количество" />
                </div>

                <ProfessorOfTheYear.Client.Components.Studyload />
            </div>

            <div class="block-content block-content-border">
                <div class="block-subtitle-text">
                    Список подготовленных под руководством участника конкурса аспирантов (докторантов) за последние пять лет научно-педагогической деятельности
                </div>

                <div class="block-content-text">Количество защитившихся кандидатов наук:</div>
                <div class="input-group mb-3">
                    <ValidationMessage For="@(() => invoice.candidatesOfSciencesCount)" />
                    <InputNumber class="form-control" @bind-Value="invoice.candidatesOfSciencesCount" Placeholder="Введите количество" />
                </div>

                <div class="block-content-text">Количество защитившихся докторов наук:</div>
                <div class="input-group mb-3">
                    <ValidationMessage For="@(() => invoice.doctorsOfSciencesCount)" />
                    <InputNumber class="form-control" @bind-Value="invoice.doctorsOfSciencesCount" Placeholder="Введите количество" />
                </div>

                <ProfessorOfTheYear.Client.Components.Studentlist />
            </div>

            <div class="d-flex flex-row gap-2 mt-2 mb-2 justify-content-center">
                <Button 
                    @onclick="Comeback"
                    Color="ButtonColor.Secondary">
                        Вернуться назад
                </Button>
                <Button 
                    Type="ButtonType.Submit"
                    Color="ButtonColor.Primary">
                        Продолжить
                </Button>
            </div>
        </EditForm>
    </div>
</div>

@code {
    private Invoice invoice = new();
    private EditContext? editContext;

    protected override void OnInitialized()
    {
        editContext = new EditContext(invoice);
        base.OnInitialized();
    }

    public void HandleOnValidSubmit()
    {
        NavigationManager.NavigateTo("/form/scientific-works");
    }

    public void Comeback()
    {
        NavigationManager.NavigateTo("/form/scientific-exp");
    }

    public class Invoice
    {
        public int? bachelorscCount { get; set; }

        public int? specialistsCount { get; set; }

        public int? mastersCount { get; set; }
        public int? candidatesOfSciencesCount { get; set; }
        public int? doctorsOfSciencesCount { get; set; }
    }
}
